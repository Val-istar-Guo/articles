# 前端项目进化论

###### 但凡就职过几家公司，就必然接受过许多历史项目。这些项目的技术栈自从确立开始便不再更新迭代。我们备受折磨，甚至破口大骂。然而又无能为力。就像是在这个时代寻找win98的开发资料一样，何其艰难又毫无意义。

我就职过两家公司，我接手过React/Angular2/Java三个技术混写在一起的仓库。也在团队中维护过数个React项目，它们拥有着相同的技术栈，每个项目的React或其他外部依赖的版本却截然不同。我们团队努力将有需求的项目依赖升级到最新版本。然而依旧有许多改动不频繁的项目，两年之后，已经没人敢再升级其依赖了。

我经常想：“为什么我们拥有着这么多个体实力非常棒的小伙伴，却总是不可避免的走向深渊。”我们甚至没有能力持续的维护团队技术栈的统一（除了每隔一段时间重构）。人员的交替更是这问题的催化剂。终有一天，被恶魔摧毁。


## 领导者

维护团队项目的持续稳定发展是领导者的责任之一。但是很多情况下这都不会受到重视。当需要维护一个古老项目时，总会有一个人被“临危受命”。

> 美国的领导者每隔两届便会变更一次党派，每个领导者上任第一件事就是废除前任设定的政策和法案。这导致在美国很难实施一些长远的规划。

在我们的团队之中，所有的KPI都是去开拓新的领域，占领新的市场，研发新的项目。没有人花费太多精力去关注那些已经在默默运行中的系统。更没人去考虑，这些系统真的需要升级时的事情。关注这些事情既不能在晋升时给评委留下什么印象；更何况，那时“我”可能已经不在此地。等到某天，那个系统已经难以挽救时。要么撂挑子走人，以一个曾经的团队开拓者的形象入驻新的团队，将烂摊子留给其他人收拾。要么设立一个新项目去重构就项目，花费大量的资源将其打造成一个“意义重大”的项目革新。

最终，总是会投入一笔本并不需要如此巨大的资源解决年久失修的问题。然后营造一个又一个的KPI项目。有时候感叹，天朝真的时KPI项目的沃土。

我认识的许多团队的领导者，更像是一个开拓者，一位猛将。他骁勇善战，无可匹敌。总是能够攻克一个又一个城池。却留下一地骸骨，和破烂不堪的市井小巷。“元朝”不过持续了97年。建立起良好的团队制度，才能长盛不衰。


## 工具

如果团队意识到了这个问题，那么就应当开始着手解决问题。项目的发展与业务关系密切，与团队关系疏远。必须要借助一些工具，使得所有项目能够集中管理。这是解决问题的根本方法。我这认为两个工具非常有帮助，分别是[Lerna]()和[Mili]():


### [Lerna](https://github.com/lerna/lerna#readme)

> A tool for managing JavaScript projects with multiple packages.

[Lerna](https://github.com/lerna/lerna#readme) 非常使用用于管理多个有关联关系的项目。这种管理方案需要将所有项目放在同一个Git仓库之中，所有项目的统一配置和依赖都集中管理、集中升级，保障了步调一致。也因此，每次技术升级都需要对所有项目进行测试。

此工具优点在于每一次技术升级和变更都能够让所有项目完成升级。同样的，也需要团队对每一个项目都有所了解。因此非常适合有关联关系的多个项目使用。例如babel和babel的众多插件就是使用这个工具进行技术管理的。但是，Git并不适合存储超大的单个项目，没有关联关系的多个项目使用[Lerna](https://github.com/lerna/lerna#readme)管理并不是很好的选择。

### [Mili](https://github.com/mili-project-manager/mili)

[Mili](https://github.com/mili-project-manager/mili)使用模板引擎约束多个项目的项目内容和结构。它提供了模板检查、模板升级等功能。
配合CI检查模板的版本是否过期，可以实现对团队项目的统一管理和统一升级。
与[Lerna](https://github.com/lerna/lerna#readme)不同，它不需要将多个项目合并成一个仓库。而是通过升级模板，为所有项目的内容和结构提供升级。每个项目依旧能够独立的开发和管理。但是在模板的束缚下，开发者不可能擅自变更不符合模板规范的文件内容。

[Lerna](https://github.com/lerna/lerna#readme)有些像是一个脚手架工具。但与其他脚手架不同，其提供的模板升级和检查功能，非常适合维护多个相互独立的项目，并保持一致规范。

## 如何维持前端团队众多项目的持续进化

我认为最重要的时团队的领导者要意识到项目维持持续高质量的重要性，而不是不断地将全部资源投入到新的需求之中。或许由于大环境的原因也存在无能为力，在此不再讨论。做正确的事本就很难。

另外，借助科学的工具是必须的。
现在微服务、微前端的概念兴起。一个团队维护的项目数量比团队人力增加的快得多。单独维护每个服务的人力成本及其高昂的。若不借助[Lerna](https://github.com/lerna/lerna#readme)和[Mili](https://github.com/mili-project-manager/mili)这类的工具，灾难终将临门。

愿未来我们不需要再将大量的精力，花费在无意义的事情之中。
